<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Juego de Matem√°ticas - Infantil & Primaria</title>
  <!-- Tailwind CDN (requiere conexi√≥n a Internet) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Pequenas mejoras adicionales */
    .emoji-big { font-size: 6rem; line-height: 1; }
    .fade-in { animation: fadeIn .25s ease both; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(-6px);} to { opacity: 1; transform: translateY(0);} }
  </style>
</head>
<body class="bg-gradient-to-br from-sky-50 to-indigo-50 min-h-screen font-sans">
  <div class="max-w-4xl mx-auto p-6">
    <header class="text-center mb-6">
      <h1 class="text-4xl font-extrabold text-indigo-700">Juego de Matem√°ticas</h1>
      <p class="mt-2 text-gray-600">Suma, Resta, Multiplica y Divide ‚Äî dise√±ado para ni√±os de 5 a 7 a√±os</p>
    </header>

    <!-- Aplicaci√≥n: varias pantallas en un solo archivo -->
    <main id="app" class="bg-white rounded-2xl shadow-lg p-6">

      <!-- Pantalla de aprendizaje -->
      <section id="learn-screen">
        <h2 class="text-2xl font-bold text-indigo-600 mb-4">Aprendamos las 4 operaciones</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <article class="p-4 rounded-xl border border-indigo-100 bg-indigo-50">
            <h3 class="font-semibold">Suma (+)</h3>
            <p class="text-sm text-gray-700">Elementos: <strong>Sumandos</strong> y el <strong>total / suma</strong>. Nos permite juntar cantidades.</p>
            <p class="mt-2 font-mono">Ejemplo: 3 + 2 = 5 (3 y 2 son sumandos; 5 es la suma)</p>
          </article>

          <article class="p-4 rounded-xl border border-yellow-100 bg-yellow-50">
            <h3 class="font-semibold">Resta (-)</h3>
            <p class="text-sm text-gray-700">Elementos: <strong>Minuendo</strong>, <strong>Sustraendo</strong> y <strong>Diferencia</strong>. Nos permite quitar una parte.</p>
            <p class="mt-2 font-mono">Ejemplo: 6 - 2 = 4 (6 es minuendo, 2 es sustraendo, 4 es diferencia)</p>
          </article>

          <article class="p-4 rounded-xl border border-green-100 bg-green-50">
            <h3 class="font-semibold">Multiplicaci√≥n (√ó)</h3>
            <p class="text-sm text-gray-700">Elementos: <strong>Factores</strong> y <strong>Producto</strong>. Es sumar el mismo n√∫mero varias veces.</p>
            <p class="mt-2 font-mono">Ejemplo: 3 √ó 2 = 6 (3 y 2 son factores; 6 es el producto)</p>
          </article>

          <article class="p-4 rounded-xl border border-pink-100 bg-pink-50">
            <h3 class="font-semibold">Divisi√≥n (√∑)</h3>
            <p class="text-sm text-gray-700">Elementos: <strong>Dividendo</strong>, <strong>Divisor</strong>, <strong>Cociente</strong> y posible <strong>Resto</strong>. Es repartir en partes iguales.</p>
            <p class="mt-2 font-mono">Ejemplo: 7 √∑ 3 = 2 y resto 1 (7 es dividendo, 3 divisor, 2 cociente, 1 resto)</p>
          </article>
        </div>

        <div class="mt-6 flex flex-col md:flex-row md:items-center md:justify-between gap-4">
          <div class="space-y-2">
            <label class="block font-semibold">Nivel de aprendizaje</label>
            <select id="level" class="rounded-lg border p-2 w-64">
              <option value="inf1">Infantil 1 ‚Äî Sumas</option>
              <option value="inf2">Infantil 2 ‚Äî Sumas y Restas</option>
              <option value="pri1">Primaria 1 ‚Äî Sumas, Restas, Multiplicaciones</option>
              <option value="pri2">Primaria 2 ‚Äî Todas las operaciones</option>
            </select>
          </div>

          <div class="space-y-2">
            <label class="block font-semibold">Dificultad</label>
            <div class="flex gap-2">
              <button id="easyBtn" class="px-4 py-2 rounded-lg border bg-white">F√°cil (1 d√≠gito)</button>
              <button id="hardBtn" class="px-4 py-2 rounded-lg border bg-white">Dif√≠cil (2 d√≠gitos)</button>
            </div>
          </div>

          <div class="flex items-end">
            <button id="startGame" class="bg-indigo-600 text-white px-6 py-3 rounded-xl font-bold shadow hover:scale-105 transition">Empezar juego</button>
          </div>
        </div>

        <p class="mt-4 text-sm text-gray-500">Consejo: usa la dificultad <strong>F√°cil</strong> para practicar la comprensi√≥n y la <strong>Dif√≠cil</strong> si ya controlas los n√∫meros de dos cifras.</p>
      </section>

      <!-- Pantalla de juego -->
      <section id="game-screen" class="hidden">
        <div class="flex items-center justify-between mb-4">
          <div class="flex gap-4 items-center">
            <div class="text-sm text-gray-600">Nivel: <span id="display-level" class="font-semibold"></span></div>
            <div class="text-sm text-gray-600">Dificultad: <span id="display-diff" class="font-semibold"></span></div>
          </div>
          <div class="flex gap-4 items-center">
            <div class="bg-green-50 border border-green-200 rounded-lg px-3 py-2 text-sm">Aciertos: <span id="score-correct">0</span></div>
            <div class="bg-red-50 border border-red-200 rounded-lg px-3 py-2 text-sm">Fallos: <span id="score-wrong">0</span></div>
            <button id="backBtn" class="text-sm text-indigo-600 underline">Volver</button>
          </div>
        </div>

        <div class="rounded-xl border border-gray-100 p-6 mb-4 bg-gradient-to-br from-white to-slate-50">
          <div class="text-center">
            <div id="problem" class="text-5xl font-bold text-gray-800 mb-4">2 + 2 = ?</div>
            <div id="extra-info" class="text-sm text-gray-600 mb-4">Introduce la respuesta en el campo y pulsa Comprobar</div>

            <div id="answer-area" class="flex flex-col items-center gap-3">
              <input id="answerInput" type="text" inputmode="numeric" class="w-48 text-center text-2xl rounded-lg border p-2" autocomplete="off" />

              <!-- For division we will show two inputs -->
              <div id="division-inputs" class="hidden gap-2 items-center">
                <input id="quotientInput" type="text" inputmode="numeric" placeholder="Cociente" class="w-32 text-center text-2xl rounded-lg border p-2" />
                <div class="text-2xl">+</div>
                <input id="remainderInput" type="text" inputmode="numeric" placeholder="Resto" class="w-20 text-center text-2xl rounded-lg border p-2" />
              </div>

              <div class="flex gap-3 mt-2">
                <button id="checkBtn" class="bg-indigo-500 text-white px-6 py-2 rounded-lg font-semibold">Comprobar</button>
                <button id="skipBtn" class="bg-gray-100 px-4 py-2 rounded-lg">Saltar</button>
              </div>
            </div>

            <div id="feedback" class="mt-6 h-36 flex flex-col items-center justify-center"></div>
          </div>
        </div>

        <div class="flex justify-between items-center">
          <div class="text-sm text-gray-600">Operaciones realizadas: <span id="attempts">0</span></div>
          <div class="text-sm text-gray-600">Progreso: <span id="progress">0</span>/10</div>
        </div>
      </section>

    </main>

    <footer class="text-center text-xs text-gray-500 mt-4">Archivo √∫nico: guarda este documento como <strong>juego_matematicas.html</strong> y √°brelo con doble clic.</footer>
  </div>

  <script>
    // --- Variables y selectores ---
    const learnScreen = document.getElementById('learn-screen');
    const gameScreen = document.getElementById('game-screen');
    const startGame = document.getElementById('startGame');
    const levelSelect = document.getElementById('level');
    const easyBtn = document.getElementById('easyBtn');
    const hardBtn = document.getElementById('hardBtn');
    const displayLevel = document.getElementById('display-level');
    const displayDiff = document.getElementById('display-diff');
    const problemEl = document.getElementById('problem');
    const extraInfo = document.getElementById('extra-info');
    const answerInput = document.getElementById('answerInput');
    const checkBtn = document.getElementById('checkBtn');
    const skipBtn = document.getElementById('skipBtn');
    const feedback = document.getElementById('feedback');
    const backBtn = document.getElementById('backBtn');
    const scoreCorrect = document.getElementById('score-correct');
    const scoreWrong = document.getElementById('score-wrong');
    const attemptsEl = document.getElementById('attempts');
    const progressEl = document.getElementById('progress');
    const divisionInputs = document.getElementById('division-inputs');
    const quotientInput = document.getElementById('quotientInput');
    const remainderInput = document.getElementById('remainderInput');

    // Estado
    let difficulty = 'easy'; // easy | hard
    let level = 'inf1';
    let operators = ['+'];
    let currentProblem = null;
    let score = { correct: 0, wrong: 0, attempts: 0 };
    let progress = 0;

    // Inicializar botones de dificultad
    function setDifficulty(d) {
      difficulty = d;
      if (d === 'easy') {
        easyBtn.classList.add('bg-indigo-100');
        hardBtn.classList.remove('bg-indigo-100');
      } else {
        hardBtn.classList.add('bg-indigo-100');
        easyBtn.classList.remove('bg-indigo-100');
      }
    }

    easyBtn.addEventListener('click', () => setDifficulty('easy'));
    hardBtn.addEventListener('click', () => setDifficulty('hard'));

    // Asignar operadores por nivel
    function setOperatorsByLevel(lvl) {
      level = lvl;
      if (lvl === 'inf1') operators = ['+'];
      else if (lvl === 'inf2') operators = ['+', '-'];
      else if (lvl === 'pri1') operators = ['+', '-', '*'];
      else if (lvl === 'pri2') operators = ['+', '-', '*', '/'];
    }

    levelSelect.addEventListener('change', (e) => setOperatorsByLevel(e.target.value));

    // Convertir nivel a texto para muestra
    function levelText(lvl) {
      switch (lvl) {
        case 'inf1': return 'Infantil 1';
        case 'inf2': return 'Infantil 2';
        case 'pri1': return 'Primaria 1';
        case 'pri2': return 'Primaria 2';
      }
    }

    function diffText(d) { return d === 'easy' ? 'F√°cil' : 'Dif√≠cil'; }

    // Generador de n√∫meros segun dificultad
    function randInt(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }

    function genNumber() {
      if (difficulty === 'easy') return randInt(1, 9);
      return randInt(10, 99);
    }

    // Generador de problema
    function generateProblem() {
      const op = operators[randInt(0, operators.length - 1)];
      let a, b;
      if (op === '+') {
        a = genNumber(); b = genNumber();
        return { op, a, b, answer: a + b };
      }
      if (op === '-') {
        // Asegurar no negativos para ni√±os: minuendo >= sustraendo
        a = genNumber(); b = genNumber();
        if (b > a) [a, b] = [b, a];
        return { op, a, b, answer: a - b };
      }
      if (op === '*') {
        // Para multiplicaci√≥n usar n√∫meros peque√±os si easy o limitar productos
        if (difficulty === 'easy') { a = randInt(1,9); b = randInt(1,9); }
        else { a = randInt(2,12); b = randInt(2,9); }
        return { op, a, b, answer: a * b };
      }
      if (op === '/') {
        // Divisi√≥n: permitimos resto. Generaremos dividendo y divisor.
        let divisor = difficulty === 'easy' ? randInt(1,9) : randInt(2,12);
        let quotient = difficulty === 'easy' ? randInt(0,9) : randInt(0,15);
        let remainder = difficulty === 'easy' ? randInt(0, Math.max(0, divisor-1)) : randInt(0, Math.max(0, divisor-1));
        let dividend = divisor * quotient + remainder;
        // Asegurar dividend no cero
        if (dividend === 0) { dividend = divisor; quotient = 1; remainder = 0; }
        return { op: '/', a: dividend, b: divisor, quotient, remainder };
      }
    }

    // Mostrar problema
    function showProblem() {
      currentProblem = generateProblem();
      progressEl.textContent = progress;
      attemptsEl.textContent = score.attempts;

      if (currentProblem.op === '/') {
        problemEl.textContent = `${currentProblem.a} √∑ ${currentProblem.b} = ?`;
        divisionInputs.classList.remove('hidden');
        answerInput.classList.add('hidden');
        answerInput.value = '';
        quotientInput.value = '';
        remainderInput.value = '';
        extraInfo.textContent = 'Introduce cociente y resto, luego pulsa Comprobar.';
      } else {
        divisionInputs.classList.add('hidden');
        answerInput.classList.remove('hidden');
        answerInput.value = '';
        problemEl.textContent = `${currentProblem.a} ${currentProblem.op} ${currentProblem.b} = ?`;
        extraInfo.textContent = 'Introduce la respuesta y pulsa Comprobar.';
      }

      // limpiar feedback
      feedback.innerHTML = '';
      answerInput.focus();
    }

    // Comprobar respuesta
    function checkAnswer() {
      if (!currentProblem) return;
      score.attempts += 1;
      attemptsEl.textContent = score.attempts;

      let correct = false;
      if (currentProblem.op === '/') {
        const q = parseInt(quotientInput.value);
        const r = parseInt(remainderInput.value);
        correct = (!isNaN(q) && !isNaN(r) && q === currentProblem.quotient && r === currentProblem.remainder);
      } else {
        const val = parseInt(answerInput.value);
        correct = (!isNaN(val) && val === currentProblem.answer);
      }

      if (correct) {
        score.correct += 1;
        progress = Math.min(10, progress + 1);
        showFeedback(true);
      } else {
        score.wrong += 1;
        showFeedback(false);
      }

      scoreCorrect.textContent = score.correct;
      scoreWrong.textContent = score.wrong;
      progressEl.textContent = progress + '/10';

      // Tras 3 segundos, pasar a siguiente problema. Si llegamos a 10, mostramos resumen.
      setTimeout(() => {
        if (progress >= 10) {
          showSummary();
        } else {
          showProblem();
        }
      }, 1200);
    }

    // Mostrar feedback
    function showFeedback(isCorrect) {
      feedback.innerHTML = '';
      const box = document.createElement('div');
      box.className = 'w-full rounded-xl p-4 text-center';
      box.classList.add('fade-in');
      if (isCorrect) {
        box.innerHTML = `<div class="emoji-big">üéâ</div><div class="mt-2 text-lg font-bold text-green-700">¬°Muy bien! ¬°Correcto!</div><div class="text-sm text-gray-600 mt-1">Sigue as√≠</div>`;
      } else {
        let correctText = '';
        if (currentProblem.op === '/') {
          correctText = `Cociente = ${currentProblem.quotient}, Resto = ${currentProblem.remainder}`;
        } else {
          correctText = `Respuesta correcta: ${currentProblem.answer}`;
        }
        box.innerHTML = `<div class="emoji-big">üòÖ</div><div class="mt-2 text-lg font-bold text-red-600">Casi ‚Äî intenta de nuevo</div><div class="text-sm text-gray-600 mt-1">${correctText}</div>`;
      }
      feedback.appendChild(box);
    }

    // Mostrar resumen final
    function showSummary() {
      gameScreen.querySelector('#problem').textContent = '¬°Juego terminado!';
      feedback.innerHTML = `<div class="p-6 text-center"><div class="emoji-big">üèÜ</div><h3 class="mt-3 text-2xl font-bold">Resumen</h3><p class="mt-2">Aciertos: <strong>${score.correct}</strong> ‚Äî Fallos: <strong>${score.wrong}</strong></p><button id="playAgain" class="mt-4 bg-indigo-600 text-white px-5 py-2 rounded-lg">Jugar otra vez</button></div>`;
      const playAgain = document.getElementById('playAgain');
      playAgain.addEventListener('click', () => {
        resetGame();
        showProblem();
      });
    }

    // Resetear juego
    function resetGame() {
      score = { correct: 0, wrong: 0, attempts: 0 };
      progress = 0;
      scoreCorrect.textContent = 0;
      scoreWrong.textContent = 0;
      attemptsEl.textContent = 0;
      progressEl.textContent = '0/10';
      feedback.innerHTML = '';
    }

    // Evento de inicio
    startGame.addEventListener('click', () => {
      setOperatorsByLevel(levelSelect.value);
      setDifficulty(difficulty);
      displayLevel.textContent = levelText(levelSelect.value);
      displayDiff.textContent = diffText(difficulty);
      learnScreen.classList.add('hidden');
      gameScreen.classList.remove('hidden');
      resetGame();
      showProblem();
    });

    // Botones de juego
    checkBtn.addEventListener('click', checkAnswer);
    skipBtn.addEventListener('click', () => {
      score.attempts += 1;
      score.wrong += 1;
      attemptsEl.textContent = score.attempts;
      scoreWrong.textContent = score.wrong;
      progress = Math.min(10, progress + 1);
      setTimeout(() => {
        if (progress >= 10) showSummary(); else showProblem();
      }, 600);
    });

    backBtn.addEventListener('click', () => {
      gameScreen.classList.add('hidden');
      learnScreen.classList.remove('hidden');
    });

    // Permitir Enter para comprobar
    answerInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') checkAnswer(); });
    quotientInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') checkAnswer(); });
    remainderInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') checkAnswer(); });

    // Inicial
    setDifficulty('easy');
    setOperatorsByLevel(levelSelect.value);
  </script>
</body>
</html>
